<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>Detectives</title>
		<link rel="stylesheet" href="style.css" />
		<style>
			body {
				margin: 0;
				min-height: 100vh;
				font-family: "Segoe UI", "Helvetica Neue", Arial, sans-serif;
				background: url("bg.jpg") center/cover no-repeat;
				color: #1f2a33;
				display: flex;
				align-items: center;
				justify-content: center;
			}

			.hero {
				position: relative;
				text-align: center;
				padding: 60px 24px;
				border-radius: 24px;
				background: transparent;
				box-shadow: none;
				max-width: 720px;
				width: 90%;
			}

			.hero h1 {
				margin: 0 0 12px;
				font-size: 3.4rem;
				letter-spacing: 1.5px;
				text-transform: uppercase;
			}

			.hero p {
				margin: 0 0 28px;
				font-size: 1.15rem;
				color: #1f2a33;
				font-weight: 600;
			}

			.btn-primary {
				padding: 14px 28px;
				border: none;
				border-radius: 14px;
				background: linear-gradient(135deg, #ff7f50, #ffb347);
				color: #1c0f0f;
				font-weight: 800;
				font-size: 1.1rem;
				cursor: pointer;
				box-shadow: 0 16px 28px rgba(255, 127, 80, 0.35);
				transition: transform 0.2s, box-shadow 0.2s;
			}

			.btn-primary:hover {
				transform: translateY(-2px);
				box-shadow: 0 20px 32px rgba(255, 127, 80, 0.45);
			}

			.modal-overlay {
				position: fixed;
				inset: 0;
				background: rgba(0, 0, 0, 0.45);
				display: none;
				align-items: center;
				justify-content: center;
				z-index: 10;
			}

			.modal {
				background: #fffdf5;
				border-radius: 16px;
				padding: 20px;
				min-width: 320px;
				max-width: 420px;
				box-shadow: 0 24px 48px rgba(0, 0, 0, 0.2);
			}

			.modal h3 {
				margin-top: 0;
			}

			.modal .choices {
				display: grid;
				gap: 10px;
				margin-top: 12px;
			}

			.choice-btn {
				padding: 12px;
				border-radius: 10px;
				border: 1px solid #e8d7a0;
				background: #fffaf0;
				font-weight: 700;
				cursor: pointer;
				transition: all 0.2s;
			}

			.choice-btn:hover {
				background: #ffecc2;
				transform: translateY(-1px);
			}

			.player-select {
				width: 100%;
				padding: 10px;
				border-radius: 10px;
				border: 1px solid #e8d7a0;
				background: #fffaf0;
				font-weight: 700;
			}
		</style>
	</head>
	<body>
		<div class="hero">
			<h1>Detectives</h1>
			<p>Quick table talk, bold guesses, and a mystery in the middle.</p>
			<button class="btn-primary" id="play-btn">Play Game</button>
		</div>

		<div class="modal-overlay" id="mode-modal">
			<div class="modal">
				<h3>Choose a mode</h3>
				<div class="choices">
					<button class="choice-btn" id="fast-game">Fast Game</button>
					<button class="choice-btn" id="long-game">Long Game</button>
				</div>
			</div>
		</div>

		<div class="modal-overlay" id="players-modal">
			<div class="modal">
				<h3 id="players-modal-title">Long Game</h3>
				<div id="player-count-wrapper">
					<label for="player-count-input">Choose number of players</label>
					<select id="player-count-input" class="player-select">
						<option value="3">3 players</option>
						<option value="4">4 players</option>
						<option value="5">5 players</option>
						<option value="6">6 players</option>
					</select>
				</div>
				<div id="bot-options" style="margin-top: 12px; display: block">
					<label for="bot-count-input">Bots (only for 3-player game)</label>
					<select id="bot-count-input" class="player-select">
						<option value="0">3 humans</option>
						<option value="1">2 humans, 1 bot</option>
						<option value="2">1 human, 2 bots</option>
					</select>
				</div>
				<div id="names-container" style="margin-top: 12px"></div>
				<div class="choices" style="margin-top: 16px">
					<button class="btn-primary" id="start-mode">Start Game</button>
				</div>
			</div>
		</div>

		<script>
			const modeModal = document.getElementById("mode-modal");
			const playersModal = document.getElementById("players-modal");
			const playersModalTitle = document.getElementById("players-modal-title");
			const playerSelect = document.getElementById("player-count-input");
			const playerCountWrapper = document.getElementById("player-count-wrapper");
			const botSelect = document.getElementById("bot-count-input");
			const botOptions = document.getElementById("bot-options");
			const namesContainer = document.getElementById("names-container");
			let currentModeChoice = "long";

			const buildNameInputs = () => {
				const total = parseInt(playerSelect.value, 10);
				const bots = playerSelect.value === "3" ? parseInt(botSelect.value, 10) : 0;
				const humans = total - bots;
				namesContainer.innerHTML = "";
				const slots = [];
				for (let i = 0; i < humans; i++) {
					slots.push({
						type: "human",
						label: `Player ${i + 1}`,
						placeholder: `Player ${i + 1}`,
					});
				}
				for (let b = 0; b < bots; b++) {
					slots.push({
						type: "bot",
						label: `Bot ${b + 1}`,
						name: `Bot ${b + 1}`,
					});
				}
				slots.forEach((slot, idx) => {
					const wrap = document.createElement("div");
					wrap.style.marginBottom = "8px";
					if (slot.type === "human") {
						const label = document.createElement("label");
						label.textContent = `${slot.label} name`;
						label.style.display = "block";
						const input = document.createElement("input");
						input.type = "text";
						input.className = "player-select name-entry";
						input.style.width = "100%";
						input.dataset.idx = idx;
						input.dataset.label = slot.placeholder;
						input.placeholder = slot.placeholder;
						wrap.appendChild(label);
						wrap.appendChild(input);
					} else {
						const label = document.createElement("label");
						label.textContent = `${slot.label} (bot)`;
						label.style.display = "block";
						const botTag = document.createElement("div");
						botTag.className = "player-select";
						botTag.style.padding = "10px";
						botTag.textContent = slot.name;
						botTag.dataset.name = slot.name;
						botTag.dataset.type = "bot";
						wrap.appendChild(label);
						wrap.appendChild(botTag);
					}
					namesContainer.appendChild(wrap);
				});
			};
			document.getElementById("play-btn").onclick = () => {
				modeModal.style.display = "flex";
			};
			document.getElementById("fast-game").onclick = () => {
				currentModeChoice = "fast";
				playersModalTitle.textContent = "Fast Game";
				playerSelect.value = "3";
				playerSelect.disabled = true;
				playerCountWrapper.style.display = "none";
				botOptions.style.display = "block";
				buildNameInputs();
				modeModal.style.display = "none";
				playersModal.style.display = "flex";
			};
			document.getElementById("long-game").onclick = () => {
				currentModeChoice = "long";
				playersModalTitle.textContent = "Long Game";
				playerSelect.disabled = false;
				playerCountWrapper.style.display = "block";
				modeModal.style.display = "none";
				playersModal.style.display = "flex";
				botOptions.style.display = playerSelect.value === "3" ? "block" : "none";
				buildNameInputs();
			};
			playerSelect.addEventListener("change", () => {
				botOptions.style.display = playerSelect.value === "3" ? "block" : "none";
				buildNameInputs();
			});
			botSelect.addEventListener("change", () => {
				buildNameInputs();
			});
			document.getElementById("start-mode").onclick = () => {
				const players = currentModeChoice === "fast" ? "3" : playerSelect.value;
				const botCount = players === "3" ? botSelect.value : 0;
				const entries = namesContainer.querySelectorAll(".name-entry, [data-type='bot']");
				const names = Array.from(entries).map((el) => {
					if (el.classList.contains("name-entry")) {
						return el.value || el.dataset.label || "Player";
					}
					return el.dataset.name || "Bot";
				});
				const namesParam = encodeURIComponent(JSON.stringify(names));
				const modeParam = currentModeChoice === "fast" ? "fast" : "hard";
				window.location.href = `start.html?mode=${modeParam}&players=${players}&bots=${botCount}&names=${namesParam}`;
			};
			buildNameInputs();
			[modeModal, playersModal].forEach((modal) => {
				modal.addEventListener("click", (e) => {
					if (e.target === modal) modal.style.display = "none";
				});
			});
		</script>
	</body>
</html>
